# 🚀 部署到雲端 - 讓全世界都能用你的工具

> **讓你的作品上線！** 從本地開發到雲端部署，讓同事、朋友都能直接使用

---

## 📖 為什麼要學部署？

你已經用 AI 做出了很多實用工具：
- 📊 數據分析儀表板
- 📁 檔案整理工具
- 🕷️ 網頁資料爬蟲
- 📈 自動化報表

但這些工具現在只能在 Codespaces 中執行，**只有你自己能用**。

學會部署後：
- ✅ 同事可以直接開網頁使用
- ✅ 不需要安裝任何軟體
- ✅ 24/7 持續運行
- ✅ 自動更新（你改程式碼，網站自動更新）

---

## 🎯 學習目標

完成本章節後，你將學會：
1. 將 Streamlit 應用部署到 Streamlit Cloud（**最簡單**）
2. 將任何 Python 應用部署到 Render（**更靈活**）
3. 設定自動部署（push 到 GitHub 就自動更新）
4. 管理環境變數和設定檔

---

## 📋 課程大綱

| 階段 | 內容 | 時間 | 難度 |
|------|------|------|------|
| 🥇 階段一 | 部署 Streamlit 應用 | 20-30 分鐘 | ⭐ |
| 🥈 階段二 | 部署到 Render | 30-40 分鐘 | ⭐⭐ |
| 🥉 階段三 | 設定自動部署 | 15-20 分鐘 | ⭐ |

---

## 🎮 實戰演練

### 任務 1：部署銷售數據儀表板（Streamlit Cloud）

**情境**：你做了一個銷售數據分析工具，主管希望每天都能查看最新數據。

#### 1️⃣ 準備你的專案

確認你的專案有以下檔案：
```
your_project/
├── app.py                 # 主程式
├── requirements.txt       # 套件清單
└── data/                  # 資料檔案（選用）
    └── sales.csv
```

**你可以這樣說：**

```
我想做一個銷售數據儀表板，顯示每月銷售額、前五名產品、趨勢圖，使用 data/sales.csv 的資料
```

```
幫我生成 requirements.txt
```

---

#### 2️⃣ 推送到 GitHub

**你可以這樣說：**

```
幫我把這個專案推送到 GitHub
```

> 💡 **提示**：如果還沒建立 GitHub 專案，可以在 GitHub 網站上點擊「New repository」

---

#### 3️⃣ 部署到 Streamlit Cloud

**步驟說明**（用瀏覽器操作）：

1. **前往 Streamlit Cloud**
   - 開啟：https://streamlit.io/cloud
   - 點擊「Sign up」或「Sign in with GitHub」

2. **授權 GitHub**
   - 選擇「Authorize Streamlit」

3. **新增應用**
   - 點擊「New app」
   - 選擇你的 GitHub 專案
   - 主檔案：`app.py`
   - 點擊「Deploy!」

4. **等待部署**（約 2-3 分鐘）

5. **分享網址**
   - 你的應用網址會是：`https://你的帳號-專案名稱.streamlit.app`

---

### 任務 2：部署自動化工具到 Render

**情境**：你做了一個每天自動抓取競品價格的爬蟲工具，需要 24/7 運行。

#### 1️⃣ 準備專案檔案

```
price_monitor/
├── app.py                 # 主程式（Flask API）
├── scraper.py             # 爬蟲邏輯
├── requirements.txt       # 套件清單
└── README.md              # 說明文件
```

**你可以這樣說：**

```
我想做一個價格監控工具，每小時抓取三個競品網站的價格，提供 API 讓其他人查詢最新價格
```

```
測試成功！幫我準備部署到 Render
```

---

#### 2️⃣ 部署到 Render

**步驟說明**：

1. **註冊 Render**
   - 前往：https://render.com
   - 選擇「Sign in with GitHub」

2. **建立新服務**
   - 點擊「New +」→「Web Service」
   - 選擇你的 GitHub 專案

3. **設定服務**
   - **Name**：`price-monitor`
   - **Environment**：`Python 3`
   - **Build Command**：`pip install -r requirements.txt`
   - **Start Command**：`python app.py`
   - **Plan**：選擇「Free」

4. **部署**
   - 點擊「Create Web Service」
   - 等待 3-5 分鐘

---

### 任務 3：設定自動部署

**目標**：修改程式碼後，自動更新到雲端

**好消息**：Streamlit Cloud 和 Render 都**預設支援自動部署**！

**運作方式**：
```
你修改程式碼 → Push 到 GitHub → 雲端平台自動偵測 → 自動重新部署
```

**你可以這樣說：**

```
我想在儀表板加上「匯出 Excel」功能
```

```
本地測試成功！推送到 GitHub
```

---

## 🎯 進階技巧

### 1. 環境變數管理（隱藏敏感資訊）

**Streamlit Cloud 設定**：
1. 前往應用設定 → Settings → Secrets
2. 新增 TOML 格式的設定：
   ```toml
   API_KEY = "your_secret_key"
   DATABASE_URL = "postgresql://..."
   ```

**在程式中使用**：
```python
import streamlit as st
api_key = st.secrets["API_KEY"]
```

**Render 設定**：
1. 應用設定 → Environment
2. 新增 Key-Value

**在程式中使用**：
```python
import os
api_key = os.getenv("API_KEY")
```

---

### 2. 查看執行日誌（除錯用）

**如果部署後無法正常運作**：

1. **Streamlit Cloud**：
   - 應用頁面右下角 → 「Manage app」 → 「Logs」

2. **Render**：
   - 應用頁面 → 「Logs」頁籤

**常見錯誤**：
| 錯誤 | 原因 |
|------|------|
| `ModuleNotFoundError` | 套件沒有加到 `requirements.txt` |
| `FileNotFoundError` | 檔案路徑錯誤 |
| `Port already in use` | Render 會自動設定 PORT，不要寫死 |

---

## 📊 平台比較

| 功能 | Streamlit Cloud | Render |
|------|----------------|--------|
| **適合應用** | Streamlit 儀表板 | 任何 Python 應用 |
| **免費額度** | 無限制 | 750 小時/月 |
| **部署速度** | 1-2 分鐘 | 3-5 分鐘 |
| **自動部署** | ✅ | ✅ |
| **資料庫** | ❌ | ✅（PostgreSQL） |
| **背景任務** | ❌ | ✅ |
| **推薦給** | 數據分析、報表 | 爬蟲、API、排程 |

---

## 💡 常見問題

### Q1: 部署後應用很慢？

**Streamlit Cloud**：
- 免費方案資源有限，優化建議：減少資料處理量、使用快取

**Render**：
- 免費方案閒置 15 分鐘後會休眠
- 第一次存取需要 30-60 秒啟動

---

### Q2: 可以部署需要登入的應用嗎？

**可以！** 使用內建的密碼保護：

```python
import streamlit as st

def check_password():
    if st.session_state.get("password_correct", False):
        return True
    
    password = st.text_input("請輸入密碼", type="password")
    if st.button("登入"):
        if password == st.secrets["PASSWORD"]:
            st.session_state["password_correct"] = True
            st.rerun()
        else:
            st.error("密碼錯誤")
    return False

if check_password():
    st.write("歡迎使用儀表板！")
```

---

### Q3: 部署費用會很貴嗎？

**完全不會！免費方案已經非常夠用：**
- **Streamlit Cloud**：無限制使用
- **Render**：750 小時/月（約 31 天不間斷）

只有當你需要更多資源或自訂網域時，才需要付費。

---

## 🎯 挑戰任務

### 🥇 初級挑戰
- [ ] 部署一個簡單的 BMI 計算器
- [ ] 分享網址給 3 位朋友測試

### 🥈 中級挑戰
- [ ] 部署一個檔案格式轉換工具
- [ ] 加上密碼保護

### 🥉 高級挑戰
- [ ] 部署一個每日自動執行的爬蟲
- [ ] 結果儲存到資料庫
- [ ] 建立 API 讓其他人查詢

---

## 🌟 恭喜你！

完成本章節後，你已經掌握：
- ✅ 雲端部署的完整流程
- ✅ 讓作品被全世界使用
- ✅ 自動化部署和更新
- ✅ 環境變數和設定管理

**你現在可以**：
- 把所有實用工具部署上線
- 分享給同事、朋友使用
- 在履歷上寫「具備雲端部署經驗」

---

## 📚 延伸學習

- [Streamlit Cloud 官方文件](https://docs.streamlit.io/streamlit-community-cloud)
- [Render 官方文件](https://render.com/docs)
- [GitHub Actions 自動化](https://docs.github.com/en/actions)

---

**接下來的目標**：在工作中找一個重複性任務，自動化它，然後部署上線給團隊使用！🚀
